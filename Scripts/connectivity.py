# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# Connectivity.py
# Created on: 2017-09-14 04:50:38.00000
#   (generated by ArcGIS/ModelBuilder)
# Usage: Connectivity <Streets> <City_Limits> 
# Description: 
# ---------------------------------------------------------------------------

# Import arcpy module
import arcpy

# Script arguments
Streets = arcpy.GetParameterAsText(0)

City_Limits = arcpy.GetParameterAsText(1)

# Local variables:
Intersections = "C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3"
IntersectionsXY = Intersections
IntersectionsDissolved = "C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3_Di1"
IntersectionsSpatialJoin = "C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3_Di2"
IntersectionsOver2 = "C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3_Di4"
IntersectionRaster = "C:\\Master GDB\\MasterSprawl.gdb\\hmmm"
Intersection_Density = "C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\Extract_hmmm1"
IntersectionDensityStatistics_TXT = "C:\\Users\\Jared\\AppData\\Local\\ESRI\\Desktop10.4\\SpatialAnalyst\\BandCol_Extract1.TXT"

# Process: Intersect
arcpy.Intersect_analysis("# #", Intersections, "ALL", "", "POINT")

# Process: Add XY Coordinates
arcpy.AddXY_management(Intersections)

# Process: Dissolve
arcpy.Dissolve_management(IntersectionsXY, IntersectionsDissolved, "POINT_X;POINT_Y", "", "MULTI_PART", "DISSOLVE_LINES")

# Process: Spatial Join
arcpy.SpatialJoin_analysis(IntersectionsDissolved, IntersectionsXY, IntersectionsSpatialJoin, "JOIN_ONE_TO_ONE", "KEEP_ALL", "POINT_X \"POINT_X\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3_Di1,POINT_X,-1,-1;POINT_Y \"POINT_Y\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3_Di1,POINT_Y,-1,-1;FID_Streets \"FID_Streets\" true true false 4 Long 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,FID_Streets,-1,-1;ID \"ID\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,ID,-1,-1;LENGTH \"LENGTH\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,LENGTH,-1,-1;DIR \"DIR\" true true false 2 Short 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,DIR,-1,-1;FROM_NODE \"FROM_NODE\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,FROM_NODE,-1,-1;TO_NODE \"TO_NODE\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,TO_NODE,-1,-1;PREFIX \"PREFIX\" true true false 10 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,PREFIX,-1,-1;CNAME \"CNAME\" true true false 35 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,CNAME,-1,-1;FNAME \"FNAME\" true true false 25 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,FNAME,-1,-1;MNAME \"MNAME\" true true false 35 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,MNAME,-1,-1;FDSUF \"FDSUF\" true true false 2 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,FDSUF,-1,-1;FTYPE \"FTYPE\" true true false 4 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,FTYPE,-1,-1;INTERSTATE \"INTERSTATE\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,INTERSTATE,-1,-1;US_ROUTE \"US_ROUTE\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,US_ROUTE,-1,-1;START_LEFT \"START_LEFT\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,START_LEFT,-1,-1;START_RIGH \"START_RIGH\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,START_RIGH,-1,-1;END_LEFT \"END_LEFT\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,END_LEFT,-1,-1;END_RIGHT \"END_RIGHT\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,END_RIGHT,-1,-1;LEFT_ZIP \"LEFT_ZIP\" true true false 4 Long 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,LEFT_ZIP,-1,-1;RIGHT_ZIP \"RIGHT_ZIP\" true true false 4 Long 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,RIGHT_ZIP,-1,-1;PARITY \"PARITY\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,PARITY,-1,-1;ROADWIDTH \"ROADWIDTH\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,ROADWIDTH,-1,-1;ROW \"ROW\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,ROW,-1,-1;FUNCTIONAL \"FUNCTIONAL\" true true false 18 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,FUNCTIONAL,-1,-1;MSP_CLASS \"MSP_CLASS\" true true false 18 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,MSP_CLASS,-1,-1;LN_TYPE \"LN_TYPE\" true true false 4 Long 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,LN_TYPE,-1,-1;LANE_QUAN_ \"LANE_QUAN_\" true true false 4 Long 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,LANE_QUAN_,-1,-1;LANE_QUAN1 \"LANE_QUAN1\" true true false 4 Long 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,LANE_QUAN1,-1,-1;TWLT \"TWLT\" true true false 4 Long 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,TWLT,-1,-1;LANE1WAY \"LANE1WAY\" true true false 4 Long 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,LANE1WAY,-1,-1;URBAN_AREA \"URBAN_AREA\" true true false 4 Long 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,URBAN_AREA,-1,-1;SPEED_00_A \"SPEED_00_A\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,SPEED_00_A,-1,-1;SPEED_00_B \"SPEED_00_B\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,SPEED_00_B,-1,-1;SPEED_LIMI \"SPEED_LIMI\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,SPEED_LIMI,-1,-1;AB_TIME \"AB_TIME\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,AB_TIME,-1,-1;BA_TIME \"BA_TIME\" true true false 8 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,BA_TIME,-1,-1;ONEWAY_DIR \"ONEWAY_DIR\" true true false 10 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,ONEWAY_DIR,-1,-1;CORRIDOR \"CORRIDOR\" true true false 35 Text 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,CORRIDOR,-1,-1;OnOffRamp \"OnOffRamp\" true true false 2 Short 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,OnOffRamp,-1,-1;POINT_X_1 \"POINT_X_1\" true true false 0 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,POINT_X,-1,-1;POINT_Y_1 \"POINT_Y_1\" true true false 0 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,POINT_Y,-1,-1;POINT_Z \"POINT_Z\" true true false 0 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,POINT_Z,-1,-1;POINT_M \"POINT_M\" true true false 0 Double 0 0 ,First,#,C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\ChubPocStreets_Intersect3,POINT_M,-1,-1", "INTERSECT", "", "")

# Process: Select
arcpy.Select_analysis(IntersectionsSpatialJoin, IntersectionsOver2, "Join_Count > 2")

# Process: Point Density
arcpy.gp.PointDensity_sa(IntersectionsOver2, "Join_Count", IntersectionRaster, "250", "Circle 440 MAP", "SQUARE_KILOMETERS")

# Process: Extract by Mask
arcpy.gp.ExtractByMask_sa(IntersectionRaster, City_Limits, Intersection_Density)

# Process: Band Collection Statistics
arcpy.gp.BandCollectionStats_sa("C:\\Users\\Jared\\Documents\\ArcGIS\\Default.gdb\\Extract_hmmm1", IntersectionDensityStatistics_TXT, "BRIEF")

